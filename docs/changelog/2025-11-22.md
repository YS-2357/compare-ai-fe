# 2025-11-22 변경 로그

## 로거 출력 단축

- **상태 요약**: 콘솔 로그 가독성을 높이기 위해 로거 포맷을 간소화
- **변경 내역**
  1. `app/logger.py`에서 시간 포맷을 `HH:MM:SS`, 로그 레벨을 단일 이니셜로 줄여 한 줄 로그 길이를 단축
- **미해결 과제**
  - 요약 집계/다음 입력 생성/턴 제어 노드를 LangGraph에 추가해 실제 멀티턴 루프 구성
  - LCEL 프롬프트/OutputParser 설계 및 프론트에서 턴 수/활성 모델 설정 UI 제공
- **다음 단계**
  1. 서비스 실행 로그를 점검해 추가로 줄일 수 있는 필드를 검토

## UI 가시성 및 응답 길이 개선

- **상태 요약**: 스트림 상태에 이모지 표시를 추가하고 응답 길이를 제한해 가독성을 높임
- **변경 내역**
  1. 모델 입력 프롬프트에 “5문장 이하/600자 이내” 제약을 추가해 응답 길이를 단축 (`app/services/langgraph.py`)
  2. Streamlit 부분/요약 뷰에 상태 이모지(✅/⚠️/❌)와 실행 시간을 표시하고, 모델별 상태/시간을 표로 직접 렌더링하도록 수정 (`app/ui/streamlit_app.py`)
  3. FastAPI 요약 결과에 실행 시간(`durations_ms`)을 포함해 프론트에서 표에 활용 (`app/api/routes.py`)

## 멀티턴 상태 초기화

- **상태 요약**: 멀티턴 확장을 위한 GraphState 기본값을 정비해 서비스 실행 중에도 안전하게 적용
- **변경 내역**
  1. `init_question()`에서 `max_turns=3`, `turn=1`, `conversation_history`, `current_inputs`, `active_models` 등을 초기화하고 모델별 원 응답/자기 요약을 저장하도록 확장
  2. `dispatch_llm_calls()`가 상태에 기록된 활성 모델만 병렬 실행하도록 수정
  3. `stream_graph()` 입력에 기본 턴 수/활성 모델을 포함해 반복 구조 준비
- **다음 단계**
  1. 요약/다음 입력 생성 노드와 턴 제어 노드를 추가해 실제 멀티턴 루프를 구현
