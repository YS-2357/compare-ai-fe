# 2025-11-27 변경 로그 (오전)

- **상태 요약**: 백엔드 패키지 구조 재정렬, API deps/스키마 분리, LangGraph 모듈화만 진행(로직 변경 없음)
- **변경 사항**
  1. 인증/레이트리밋 패키지화: `app/auth.py`, `app/rate_limit.py`를 각각 `app/auth/{__init__,dependencies,supabase}.py`, `app/rate_limit/{__init__,dependencies,upstash}.py`로 분할.
  2. LangGraph 구조화: 단일 `app/services/langgraph.py`를 `llm_registry.py`, `nodes.py`, `summaries.py`, `workflow.py`, `__init__.py`로 나눠 모듈화.
  3. API 정리: `app/api/deps.py`(공용 Depends), `app/api/schemas/ask.py`(요청 스키마) 추가, `routes.py` import 경로 업데이트.
  4. 서비스 패키지: `app/services/__init__.py`는 `stream_graph`만 노출하도록 유지.
  5. 인증 엔드포인트: `app/api/auth_routes.py`에 `/auth/register`, `/auth/login` 추가(Supabase Auth signUp/signIn 연동), `app/api/schemas/auth.py`에 요청/응답 모델 추가, `app/auth/supabase.py`에 `SupabaseAuthClient`/`get_auth_client` 도입, `app/api/__init__.py` 라우터 통합.
  6. 기본 사용량 제한 축소: `DAILY_USAGE_LIMIT` 기본값을 3으로 변경(`app/config.py`), UI에서 로그인/관리자 토큰 없이 `/api/ask` 호출 차단(`app/ui/streamlit_app.py`).
  7. 인증/레이트리밋 안정화: JWKS 404/401 대응으로 다중 경로 폴백(`app/auth/supabase.py`), Upstash 연결 오류 시 우회 로그 후 진행(`app/rate_limit/dependencies.py`), `.well-known/jwks.json` + 우회로 `/api/ask` 정상 동작 확인.
- **빌드/검증**
  - `python3 -m compileall app`로 경로/문법 검증(의존 LLM 호출 없음).
- **미해결/추후**
  - LangGraph call_* 공통화/중복 제거 및 멀티턴 확장 작업 미완료.
  - README/.env.example에 새 경로와 환경변수 표기 업데이트 필요.
